--- START OF FILE New File.html ---

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TAPZO PLAY - Web Edition</title>
    
    <!-- Removed Telegram Script -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* CSS remains exactly the same as per your design */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background-color: #0f172a; color: white; min-height: 100vh; display: flex; flex-direction: column; overflow-x: hidden; user-select: none; padding-bottom: 80px; }
        #loading-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #0f172a; z-index: 10000; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; padding-top: 30vh; }
        .loader-logo { width: 120px; height: 120px; border-radius: 50%; border: 4px solid #00E5FF; box-shadow: 0 0 30px rgba(0, 229, 255, 0.6); object-fit: cover; animation: pulseLogo 2s infinite; }
        .loading-bottom { position: absolute; bottom: 50px; width: 85%; text-align: center; }
        .progress-track { width: 100%; height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 20px; overflow: hidden; }
        .progress-bar { width: 0%; height: 100%; background: linear-gradient(90deg, #00E5FF, #00FF99); border-radius: 20px; transition: width 0.2s; box-shadow: 0 0 10px #00FF99; }
        .percent-text { margin-top: 15px; font-size: 16px; font-weight: bold; color: #00E5FF; letter-spacing: 1px; }
        @keyframes pulseLogo { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        #login-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); z-index: 9000; display: none; flex-direction: column; align-items: center; justify-content: center; padding: 30px; text-align: center; }
        .welcome-avatar { width: 100px; height: 100px; border-radius: 50%; border: 3px solid #00E5FF; margin-bottom: 20px; object-fit: cover; }
        .welcome-title { font-size: 24px; font-weight: bold; margin-bottom: 5px; }
        .welcome-user { color: #00E5FF; font-size: 20px; margin-bottom: 30px; }
        .btn-start { background: linear-gradient(90deg, #00E5FF, #00FF99); color: #000; border: none; padding: 15px 40px; border-radius: 30px; font-size: 18px; font-weight: bold; cursor: pointer; box-shadow: 0 5px 15px rgba(0, 255, 153, 0.3); display: flex; align-items: center; gap: 10px; }
        #main-app { display: none; width: 100%; }
        #customPopup { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 20000; display: none; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s; }
        .popup-content { background: #1e293b; padding: 25px; border-radius: 20px; width: 85%; max-width: 350px; text-align: center; border: 1px solid rgba(255,255,255,0.1); transform: scale(0.8); transition: transform 0.3s; }
        .popup-icon { font-size: 40px; margin-bottom: 15px; }
        .popup-msg { font-size: 16px; margin-bottom: 20px; line-height: 1.5; color: #e2e8f0; }
        .popup-btn { background: #00E5FF; color: black; border: none; padding: 10px 30px; border-radius: 10px; font-weight: bold; cursor: pointer; width: 100%; }
        .header { background: linear-gradient(180deg, rgba(20,30,48,0.95) 0%, rgba(36,59,85,0.95) 100%); padding: 10px 15px; text-align: center; border-bottom: 1px solid rgba(255, 255, 255, 0.1); position: sticky; top: 0; z-index: 100; backdrop-filter: blur(5px); box-shadow: 0 4px 20px rgba(0,0,0,0.4); }
        .header-top { display: flex; justify-content: center; align-items: center; gap: 10px; position: relative; }
        .logo-img { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 2px solid #00E5FF; }
        .site-title { font-size: 20px; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; }
        .text-blue { color: #00E5FF; } .text-green { color: #00FF99; }
        .notif-icon { position: absolute; right: 5px; font-size: 22px; cursor: pointer; color: #fff; }
        .notif-dot { position: absolute; top: -2px; right: -2px; width: 10px; height: 10px; background: #ff4757; border-radius: 50%; border: 2px solid #0f172a; display: none; }
        .spa-section { display: none; padding: 15px; animation: fadeIn 0.4s ease; }
        .spa-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .dashboard-card { background: linear-gradient(135deg, #11998e, #38ef7d); padding: 20px; border-radius: 20px; color: white; margin-bottom: 20px; position: relative; overflow: hidden; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 5px 15px rgba(56, 239, 125, 0.2); }
        .bal-content { z-index: 1; }
        .bal-amount { font-size: 24px; font-weight: 800; display: flex; align-items: center; gap: 5px; }
        .bal-sub { font-size: 13px; background: rgba(0,0,0,0.2); padding: 3px 8px; border-radius: 20px; margin-top: 5px; display: inline-block; }
        .card-actions { display: flex; flex-direction: column; gap: 8px; z-index: 1; align-items: flex-end; }
        .card-withdraw-btn { background: white; color: #11998e; border: none; padding: 8px 15px; border-radius: 12px; font-weight: bold; font-size: 14px; cursor: pointer; width: 100px; text-align: center; }
        .card-history-btn { background: rgba(0,0,0,0.2); color: white; border: 1px solid rgba(255,255,255,0.5); padding: 6px 15px; border-radius: 12px; font-weight: bold; font-size: 12px; cursor: pointer; width: 100px; text-align: center; }
        .section-title { font-size: 18px; font-weight: bold; margin: 15px 0; border-left: 4px solid #00E5FF; padding-left: 10px; color: #e2e8f0; text-transform: uppercase; }
        .daily-checkin-wrapper { background: #1e293b; padding: 15px; border-radius: 15px; margin-bottom: 25px; border: 1px solid rgba(255,255,255,0.05); }
        .daily-scroll-container { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 5px; }
        .day-box { flex: 0 0 85px; background: rgba(255,255,255,0.05); padding: 10px 5px; border-radius: 10px; text-align: center; position: relative; }
        .day-box i { font-size: 20px; color: #fbbf24; display: block; margin-bottom: 8px; }
        .day-box.active { background: rgba(0, 229, 255, 0.15); border: 1px solid #00E5FF; cursor: pointer; }
        .earn-grid-layout { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 25px; }
        .task-card-box { background: #1e293b; border: 2px solid rgba(255,255,255,0.05); padding: 20px 10px; border-radius: 12px; text-align: center; cursor: pointer; }
        .task-custom-img { width: 60px; height: 60px; object-fit: contain; border-radius: 10px; margin-bottom: 5px; }
        .task-name { font-size: 13px; font-weight: bold; }
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; background: #1e293b; height: 70px; display: flex; justify-content: space-around; align-items: center; border-top: 1px solid rgba(255,255,255,0.1); z-index: 1000; }
        .nav-item { display: flex; flex-direction: column; align-items: center; justify-content: center; color: #94a3b8; font-size: 12px; cursor: pointer; width: 25%; height: 100%; }
        .nav-item.active { color: #00E5FF; border-top: 3px solid #00E5FF; }
        /* Verification Modal Styles kept from original */
        #verifyModal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 15000; display: none; align-items: center; justify-content: center; }
        .verify-box { background: #1e293b; padding: 30px 20px; border-radius: 20px; width: 90%; max-width: 380px; text-align: center; border: 1px solid #00E5FF; }
        .v-input { width: 100%; padding: 12px; background: #0f172a; border: 1px solid #334155; border-radius: 10px; color: white; margin-bottom: 12px; outline: none; text-align: center; }
        .v-btn { width: 100%; padding: 12px; background: linear-gradient(90deg, #00E5FF, #00FF99); color: black; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

    <!-- 1. LOADING SCREEN -->
    <div id="loading-screen">
        <img src="https://i.ibb.co.com/xKPf6sBs/IMG-20251126-083605.jpg" class="loader-logo">
        <div class="loading-bottom">
            <div class="progress-track">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div class="percent-text" id="percentText">0%</div>
        </div>
    </div>

    <!-- 2. LOGIN (Now Name Input for non-TG) -->
    <div id="login-screen">
        <img src="https://i.ibb.co.com/xKPf6sBs/IMG-20251126-083605.jpg" class="welcome-avatar">
        <div class="welcome-title">Welcome to Tapzo Play</div>
        <input type="text" id="guestName" class="v-input" placeholder="Enter Your Name" style="margin-top: 20px;">
        <button class="btn-start" id="loginBtn">Create Account</button>
    </div>

    <!-- 3. CUSTOM POPUP -->
    <div id="customPopup">
        <div class="popup-content">
            <div class="popup-icon" id="popIcon"></div>
            <div class="popup-msg" id="popMsg"></div>
            <button class="popup-btn" onclick="closePopup()">OK</button>
        </div>
    </div>

    <!-- 4. VERIFY MODAL -->
    <div id="verifyModal">
        <div class="verify-box">
            <div class="v-icon"><i class="fa-solid fa-shield-halved"></i></div>
            <div class="v-title">Setup Withdraw Info</div>
            <input type="text" id="wName" class="v-input" placeholder="Set Withdraw Name">
            <input type="text" id="wCode" class="v-input" placeholder="Set Withdraw Code">
            <button class="v-btn" onclick="submitVerification()">SAVE & VERIFY</button>
            <div onclick="closeVerifyModal()" style="margin-top:15px; cursor:pointer; font-size:14px; color:#ff4757;">Close</div>
        </div>
    </div>

    <!-- 5. MAIN APP -->
    <div id="main-app">
        <header class="header">
            <div class="header-top">
                <img src="https://i.ibb.co.com/xKPf6sBs/IMG-20251126-083605.jpg" class="logo-img">
                <div class="site-title"><span class="text-blue">TAPZO</span> <span class="text-green">PLAY</span></div>
            </div>
        </header>

        <div id="earn" class="spa-section active">
            <div class="dashboard-card">
                <div class="bal-content">
                    <div style="font-size:12px; opacity:0.9;">Total Balance</div>
                    <div class="bal-amount"><span id="displayBalance">0</span> TAPZO</div>
                </div>
                <div class="card-actions">
                    <button class="card-withdraw-btn" onclick="switchTab('withdraw')">Withdraw</button>
                </div>
            </div>

            <div class="section-title">DAILY BONUS</div>
            <div class="daily-checkin-wrapper">
                <div class="daily-scroll-container" id="dailyCheckinList"></div>
            </div>

            <div class="section-title">TASKS</div>
            <div class="earn-grid-layout">
                <div class="task-card-box" onclick="checkVerify('task')">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTIrZBgnJ6tbNmcBsaGHrLhpl-wT-GmlebC2O4WQhNpiA&s=10" class="task-custom-img">
                    <div class="task-name">VISIT LINK</div>
                </div>
                <div class="task-card-box" onclick="checkVerify('task')">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRjVR7nVFzjJmCTkioGpd3IP7F7ZvpYQfG9wUePMOaFew&s=10" class="task-custom-img">
                    <div class="task-name">PLAY GAME</div>
                </div>
            </div>
        </div>

        <div id="profile" class="spa-section">
            <div style="text-align:center; padding: 20px;">
                <h2 id="profile-name">User</h2>
                <p id="profile-id" style="color:#94a3b8; font-size:12px;"></p>
                <div style="margin-top:20px;">
                    <button class="v-btn" id="profVerifyBtn" onclick="openVerifyModal()">Verify Account</button>
                </div>
            </div>
        </div>

        <nav class="bottom-nav">
            <div class="nav-item active" onclick="switchTab('earn', this)"><i class="fa-solid fa-coins"></i> Earn</div>
            <div class="nav-item" onclick="switchTab('profile', this)"><i class="fa-solid fa-user"></i> Profile</div>
        </nav>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, doc, getDoc, setDoc, updateDoc, collection, serverTimestamp, increment } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBfes_er_PkCOp1gKNSF8DbHxVfcvXV6TA",
            authDomain: "tapzo-play.firebaseapp.com",
            projectId: "tapzo-play",
            storageBucket: "tapzo-play.firebasestorage.app",
            messagingSenderId: "62158005008",
            appId: "1:62158005008:web:412928320987c4ae77bb95"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        
        // --- TELEGRAM REPLACEMENT SYSTEM ---
        let currentUser = null;

        // Generates a random ID if no Telegram ID is available
        const getLocalId = () => {
            let id = localStorage.getItem('tapzo_uid');
            if(!id) {
                id = 'user_' + Math.floor(Math.random() * 900000 + 100000);
                localStorage.setItem('tapzo_uid', id);
            }
            return id;
        };

        window.onload = async () => {
            let width = 0;
            const bar = document.getElementById('progressBar');
            const txt = document.getElementById('percentText');
            
            const interval = setInterval(() => {
                if (width >= 100) clearInterval(interval);
                else { width += 5; bar.style.width = width + "%"; txt.innerText = width + "%"; }
            }, 50);

            const uid = getLocalId();
            const docSnap = await getDoc(doc(db, "users", uid));

            setTimeout(() => {
                document.getElementById('loading-screen').style.display = 'none';
                if (docSnap.exists()) {
                    currentUser = docSnap.data();
                    loadApp();
                } else {
                    document.getElementById('login-screen').style.display = 'flex';
                }
            }, 1000);
        };

        document.getElementById('loginBtn').onclick = async () => {
            const name = document.getElementById('guestName').value;
            if(!name) return alert("Enter Name");

            const uid = getLocalId();
            const newUser = {
                id: uid,
                first_name: name,
                balance: 0,
                verified: false,
                currentCheckInDay: 0,
                lastCheckInTime: null
            };

            await setDoc(doc(db, "users", uid), newUser);
            currentUser = newUser;
            loadApp();
        };

        function loadApp() {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('main-app').style.display = 'block';
            updateUI();
            renderCheckIn();
        }

        function updateUI() {
            document.getElementById('displayBalance').innerText = currentUser.balance.toLocaleString();
            document.getElementById('profile-name').innerText = currentUser.first_name;
            document.getElementById('profile-id').innerText = "UID: " + currentUser.id;
            if(currentUser.verified) {
                document.getElementById('profVerifyBtn').innerText = "Verified âœ…";
                document.getElementById('profVerifyBtn').disabled = true;
            }
        }

        // Action methods
        window.switchTab = (id, el) => {
            document.querySelectorAll('.spa-section').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            if(el) {
                document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                el.classList.add('active');
            }
        };

        window.openVerifyModal = () => document.getElementById('verifyModal').style.display = 'flex';
        window.closeVerifyModal = () => document.getElementById('verifyModal').style.display = 'none';

        window.submitVerification = async () => {
            const n = document.getElementById('wName').value;
            const c = document.getElementById('wCode').value;
            if(!n || !c) return;
            
            await updateDoc(doc(db, "users", currentUser.id), { verified: true, withdrawName: n });
            currentUser.verified = true;
            updateUI();
            closeVerifyModal();
            showPopup("Account Verified!", "success");
        };

        // UI Helpers
        window.showPopup = (msg, type) => {
            const p = document.getElementById('customPopup');
            document.getElementById('popMsg').innerText = msg;
            p.style.display = 'flex';
            p.style.opacity = '1';
        };
        window.closePopup = () => document.getElementById('customPopup').style.display = 'none';

        // Simplified Daily Bonus
        window.renderCheckIn = () => {
            const container = document.getElementById('dailyCheckinList');
            container.innerHTML = '';
            for(let i=1; i<=7; i++) {
                const box = document.createElement('div');
                box.className = 'day-box' + (i === 1 ? ' active' : '');
                box.innerHTML = `<span>Day ${i}</span><i class="fa-solid fa-gift"></i><span>Locked</span>`;
                container.appendChild(box);
            }
        };

        window.checkVerify = (type) => {
            if(!currentUser.verified) openVerifyModal();
            else showPopup("Coming Soon", "info");
        };

    </script>
</body>
</html>
